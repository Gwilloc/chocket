<html>
<head>
<style type="text/css">
body {
  background: black;
  color: white;
  font-family: Arial, sans-serif;
}
#chat {
  position: absolute;
  top: 0px;
  margin: auto;
}
#chat * {
  margin: 0px;
  padding: 0px;
  line-height: 1.2em;
}
#controls {
  position: absolute;
  bottom: 0px;
  margin: auto;
}
#msg {
  display: none;
}
</style>
<script src="/socket.io/socket.io.js"></script>
<script src="http://code.jquery.com/jquery.min.js"></script>
<script>
  var socket = io.connect('/chat');

  socket.on('ready', function (data) {
    $('#chat').append('<p>You are logged in.</p>');
    $('#chat').append('<p>Users: ' + data['users'].join(',') + '</p>');
    // hide username + connect, show disconnect
    $('#username').css('display', 'none');
    $('#connect').css('display', 'none');
    $('#msg').css('display', 'inline');
  });
  socket.on('disconnect', function() {
    $('#chat').append('<p>You are disconnected.</p>');
    $('#username').css('display', 'inline');
    $('#connect').css('display', 'inline');
    $('#connect').attr('disabled', '');
    $('#msg').css('display', 'none');
  });
  socket.on('msg', function(data) {
    $('#chat').append('<p>' + data['source'] + ':'  + data['msg'] + '</p>');
  });

  function login() {
    $('#connect').attr('disabled', 'disabled');
    socket.emit('login', {username: $('#username').val()});
  }

  // bind jquery event handlers
  $(document).ready(function() {
  $('#msg').keyup(function(event) {
    if(event.keyCode == 13) {
      socket.emit('msg', {msg: event.target.value});
      event.target.value = '';
    }
  });
  });
</script>
</head>
<body>
<a href="https://github.com/MoriTanosuke/chocket"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>
<div id="chat"></div>
<div id="controls">
<input type="text" id="username" value="John Doe" />
<button id="connect" onclick="login()">Connect</button>
<input type="text" id="msg" placeholder="Enter your message here" />
</control>
</body>
</html>

